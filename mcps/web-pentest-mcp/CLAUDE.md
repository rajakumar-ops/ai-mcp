# Web Penetration Testing MCP Server - Implementation Guide

## Overview

This MCP server provides a comprehensive suite of web penetration testing tools wrapped in a secure Docker container. It's designed for educational purposes and testing your own infrastructure.

## Implementation Details

### Architecture
- **Base Image**: Kali Linux rolling release for access to security tools
- **Runtime**: Python 3 with FastMCP framework
- **Security**: Non-root user execution with input sanitization
- **Isolation**: Docker container for tool isolation

### Security Tools Included

1. **Nmap** - Network discovery and security auditing
2. **Nikto** - Web server scanner
3. **SQLMap** - SQL injection testing
4. **WPScan** - WordPress security scanner
5. **Dirb** - Web content scanner
6. **Searchsploit** - Exploit database search
7. **OpenSSL** - SSL/TLS certificate analysis
8. **HTTPX** - HTTP client for header analysis

### Tool Implementation Patterns

#### Input Sanitization
All user inputs are sanitized using the `sanitize_input()` function to prevent command injection:
```python
def sanitize_input(input_str: str) -> str:
    dangerous_chars = [';', '&', '|', '`', '$', '(', ')', '<', '>', '"', "'"]
    for char in dangerous_chars:
        input_str = input_str.replace(char, '')
    return input_str.strip()
```

#### Command Execution
All external commands are executed using `subprocess.run()` with:
- Timeout limits to prevent hanging
- Input sanitization
- Error handling
- Non-blocking execution

#### Error Handling
Each tool includes comprehensive error handling:
- Input validation
- Command execution errors
- Timeout handling
- Network connectivity issues

### Tool Categories

#### Network Scanning
- **nmap_scan**: Multiple scan types (basic, aggressive, stealth, UDP)
- **http_headers**: HTTP header analysis and security check
- **ssl_info**: SSL/TLS certificate validation

#### Web Application Testing
- **nikto_scan**: Web server vulnerability scanning
- **sqlmap_scan**: SQL injection testing
- **wpscan_scan**: WordPress-specific security testing
- **dirb_scan**: Directory and file discovery

#### Information Gathering
- **searchsploit_search**: Exploit database searching

### Configuration

#### Docker Configuration
- Non-root user execution (`pentestuser`)
- Proper file permissions
- Tool installation in `/opt/` directory
- Capability requirements for network tools

#### MCP Configuration
- FastMCP framework (no prompt decorators)
- Single-line docstrings only
- String return types
- Empty string defaults for optional parameters

### Usage Guidelines

#### For AI Assistants
- Always verify target ownership before scanning
- Use appropriate scan types for the situation
- Explain tool outputs in context
- Emphasize educational use only

#### For Users
- Only test systems you own
- Understand tool limitations
- Review outputs carefully
- Follow responsible disclosure

### Security Considerations

#### Container Security
- Non-root user execution
- Input sanitization
- Command timeout limits
- No persistent data storage

#### Network Security
- Tools run in isolated container
- No external network access beyond target
- Capability-based permissions
- Timeout-based protection

### Development Guidelines

#### Adding New Tools
1. Follow existing patterns for input sanitization
2. Use `run_command()` for subprocess execution
3. Include comprehensive error handling
4. Add appropriate timeouts
5. Update documentation

#### Testing
- Test with various input types
- Verify error handling
- Check timeout behavior
- Validate output formatting

### Troubleshooting

#### Common Issues
- **Permission errors**: Check Docker capabilities
- **Tool not found**: Verify installation in Dockerfile
- **Timeout errors**: Adjust timeout values
- **Network issues**: Check target connectivity

#### Debugging
- Check container logs: `docker logs <container>`
- Verify tool installation: `docker exec <container> which <tool>`
- Test commands manually: `docker exec <container> <command>`

### Best Practices

#### Tool Usage
- Start with basic scans before aggressive ones
- Use appropriate timeouts for target size
- Combine multiple tools for comprehensive testing
- Document findings properly

#### Security
- Never test without permission
- Use educational targets when possible
- Follow responsible disclosure
- Keep tools updated

### Future Enhancements

#### Potential Additions
- Additional vulnerability scanners
- Custom wordlists
- Report generation
- Integration with other security tools
- Automated testing workflows

#### Improvements
- Better error messages
- Progress indicators
- Result caching
- Configuration management
- Logging improvements
