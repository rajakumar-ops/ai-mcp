# Web Penetration Testing MCP Server

A Model Context Protocol (MCP) server that provides comprehensive web penetration testing tools for educational purposes.

## Purpose

This MCP server provides a secure interface for AI assistants to perform web penetration testing using industry-standard security tools. It's designed for educational purposes and testing your own infrastructure.

## Features

### Current Implementation

- **`nmap_scan`** - Network port scanning with multiple scan types (basic, aggressive, stealth, UDP)
- **`nikto_scan`** - Web vulnerability scanning for common web server issues
- **`sqlmap_scan`** - SQL injection testing with support for POST data and cookies
- **`wpscan_scan`** - WordPress security scanning including plugin and theme vulnerabilities
- **`dirb_scan`** - Directory and file brute force scanning
- **`searchsploit_search`** - Search for known exploits and vulnerabilities
- **`http_headers`** - Analyze HTTP headers and security configurations
- **`ssl_info`** - Check SSL/TLS certificate information and validity

## Prerequisites

- Docker Desktop with MCP Toolkit enabled
- Docker MCP CLI plugin (`docker mcp` command)
- Target systems for testing (only test systems you own or have permission to test)

## Installation

See the step-by-step instructions provided with the files.

## Usage Examples

In Claude Desktop, you can ask:

- "Scan my web server at 192.168.1.100 for open ports using nmap"
- "Check my WordPress site at example.com for vulnerabilities"
- "Test my web application for SQL injection vulnerabilities"
- "Find directories on my test server using directory brute force"
- "Search for exploits related to Apache 2.4.41"
- "Check the SSL certificate on my HTTPS site"
- "Analyze the security headers on my web application"

## Architecture

```
Claude Desktop → MCP Gateway → Web Pentest MCP Server → Security Tools
↓
Docker Desktop (Kali Linux Container)
```

## Development

### Local Testing

```bash
# Run directly (requires security tools installed locally)
python3 web_pentest_server.py

# Test MCP protocol
echo '{"jsonrpc":"2.0","method":"tools/list","id":1}' | python3 web_pentest_server.py
```

### Adding New Tools

1. Add the function to `web_pentest_server.py`
2. Decorate with `@mcp.tool()`
3. Update the catalog entry with the new tool name
4. Rebuild the Docker image

## Security Considerations

- All tools run in a Docker container for isolation
- Input sanitization prevents command injection
- Running as non-root user for security
- Only test systems you own or have explicit permission to test
- Educational use only - not for unauthorized testing

## Tool Descriptions

### Nmap Scanning
- **Basic**: Standard SYN scan with OS and service detection
- **Aggressive**: Comprehensive scan including UDP ports
- **Stealth**: Slow, fragmented packets to avoid detection
- **UDP**: Focus on UDP service discovery

### Nikto Web Scanning
- Scans for over 6700 potentially dangerous files/programs
- Checks for outdated versions of web servers
- Identifies server configuration problems

### SQLMap Testing
- Automated SQL injection and database takeover tool
- Supports various database management systems
- Can test POST parameters and cookies

### WPScan WordPress Testing
- Scans WordPress sites for vulnerabilities
- Checks plugins, themes, and core files
- Supports brute force attacks (with credentials)

### Dirb Directory Scanning
- Web content scanner using wordlists
- Multiple wordlist sizes available
- Identifies hidden directories and files

### Searchsploit
- Searches the Exploit Database for known vulnerabilities
- Can filter by type (web, remote, local, etc.)
- Provides exploit details and references

## Troubleshooting

### Tools Not Appearing
- Verify Docker image built successfully
- Check catalog and registry files
- Ensure Claude Desktop config includes custom catalog
- Restart Claude Desktop

### Permission Errors
- Ensure Docker container has necessary capabilities
- Run with `--cap-add=NET_RAW` for nmap
- Check that tools are properly installed in container

### Timeout Issues
- Some scans can take several minutes
- Increase timeout values for large targets
- Use smaller wordlists for faster directory scanning

## License

MIT License

## Disclaimer

This tool is for educational purposes only. Only use it on systems you own or have explicit written permission to test. Unauthorized penetration testing is illegal and unethical.
